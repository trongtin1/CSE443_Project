<!DOCTYPE html>
<html>
<head>
    @RenderSection("Styles", required: false)
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Job Connect</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link rel="stylesheet" href="~/css/client-site.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fff;
        }
        
        .header-gradient {
            background-color: #F5E7E4;
            padding-bottom: 2rem;
        }
        
        .footer-gradient {
            background-color: #F5E7E4;
            padding: 2rem 0;
        }
        
        .navbar {
            background-color: transparent !important;
            padding: 1rem 2rem;
        }
        
        .navbar-brand {
            color: #333 !important;
            font-weight: bold;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            padding: 0;
            margin-right: 2rem;
        }
        
        .navbar-brand img {
            height: 45px;
            width: auto;
            margin-right: 12px;
            object-fit: contain;
        }

        .navbar-brand .brand-text {
            display: flex;
            flex-direction: column;
            line-height: 1.2;
        }

        .navbar-brand .brand-text .main-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            letter-spacing: 0.5px;
        }

        .navbar-brand .brand-text .sub-text {
            font-size: 0.75rem;
            color: #666;
            font-weight: 500;
        }
        
        .nav-link {
            color: #333 !important;
            font-weight: 500;
            margin: 0 10px;
            transition: all 0.3s;
        }
        
        .btn-auth {
            border-radius: 20px;
            padding: 8px 20px;
            font-weight: 500;
            margin-left: 5px;
            background-color: rgba(0, 0, 0, 0.1);
            color: #333;
            border: none;
            transition: all 0.3s;
            cursor: pointer;
            outline: none;
        }
        
        .btn-auth:hover {
            background-color: rgba(0, 0, 0, 0.2);
            color: #333;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-auth.active {
            background-color: #6C63FF;
            color: white;
        }
        
        .btn-auth.active:hover {
            background-color: #5a52e0;
            color: white;
            box-shadow: 0 2px 10px rgba(108, 99, 255, 0.3);
        }
        
        .content {
            min-height: calc(100vh - 300px);
            background-color: #fff;
            padding: 2rem 0;
        }

        .main-heading {
            color: #333;
        }

        .modal-header {
            background-color: #F5E7E4;
            color: #333;
        }

        .modal-footer {
            background-color: #f8f9fc;
        }

        .tab-pane {
            padding: 20px 0;
        }

        /* form */
        /* Thu nhỏ form modal */
        .modal-dialog {
            max-width: 600px;
            margin: 2rem auto;
        }

        /* Làm form gọn và dễ nhìn */
        .modal-content {
            border-radius: 1rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            background-color: #fffaf8;
        }

        /* Canh giữa nội dung */
        .modal-body {
            padding: 1.5rem 2rem;
        }

        /* Style cho tab đăng ký */
        #registerTab {
            border-bottom: none;
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        #registerTab .nav-item {
            margin: 0 10px;
            padding: 0;
        }

        #registerTab .nav-link {
            border: none;
            border-radius: 20px;
            padding: 0.5rem 1.5rem;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
        }

        #registerTab .nav-link.active {
            background-color: #F5E7E4;
            color: #333;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        /* Làm ô input mượt và dễ nhập */
        .form-control {
            border-radius: 10px;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border: 1px solid #ddd;
            transition: border-color 0.3s;
            background-color: #fff;
            margin-bottom: 0.75rem;
        }

        .form-control:focus {
            border-color: #6C63FF;
            box-shadow: 0 0 0 0.2rem rgba(108, 99, 255, 0.1);
        }

        /* Style cho form label */
        .form-group label {
            font-weight: 500;
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 0.5rem;
        }

        /* Điều chỉnh tiêu đề và khoảng cách */
        .modal-title {
            font-weight: bold;
            font-size: 1.25rem;
            color: #333;
            text-align: center;
            width: 100%;
        }

        .modal-header {
            border-bottom: none;
            padding-bottom: 0;
            justify-content: center;
            position: relative;
        }

        .modal-header .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            opacity: 0.5;
            transition: opacity 0.3s;
        }

        .modal-header .close:hover {
            opacity: 1;
        }

        .modal-footer {
            justify-content: center;
            border-top: none;
            padding-top: 0;
        }

        /* Đẹp hơn cho nút submit */
        .btn-primary {
            background-color: #6C63FF;
            border: none;
            border-radius: 10px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            transition: all 0.3s;
            box-shadow: 0 2px 6px rgba(108, 99, 255, 0.3);
        }

        .btn-primary:hover {
            background-color: #5a52e0;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(108, 99, 255, 0.4);
        }

        /* Style cho phần checkbox */
        .custom-control-label {
            font-size: 0.9rem;
            padding-left: 0.5rem;
        }

        .custom-control-input:checked ~ .custom-control-label::before {
            background-color: #6C63FF;
            border-color: #6C63FF;
        }

        /* Style cho radio buttons */
        .custom-radio .custom-control-label::before {
            border-color: #ccc;
        }

        .custom-radio .custom-control-input:checked ~ .custom-control-label::before {
            background-color: #6C63FF;
            border-color: #6C63FF;
        }

        /* Liên kết trong modal */
        .modal a {
            color: #6C63FF;
            text-decoration: none;
            transition: color 0.3s;
        }

        .modal a:hover {
            color: #5a52e0;
            text-decoration: underline;
        }

        /* Cải thiện khoảng cách giữa các form nhóm */
        .form-row {
            margin-bottom: 0.5rem;
        }

        /* Ẩn auth-buttons khi đã đăng nhập */
        body.logged-in #auth-buttons {
            display: none !important;
        }
        
        body.logged-in #guest-menu {
            display: none !important;
        }
        
        body.logged-in #candidate-nav {
            display: flex !important;
        }

        /* CSS cho nhà tuyển dụng đã đăng nhập */
        body.recruiter-logged-in #auth-buttons {
            display: none !important;
        }
        
        body.recruiter-logged-in #guest-menu {
            display: none !important;
        }
        
        body.recruiter-logged-in #recruiter-nav {
            display: flex !important;
        }

        /* Thêm CSS để debug */
        .debug-border {
            border: 2px solid red !important;
        }
    </style>
</head>
<body>
    <div class="header-gradient">
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand" href="/Client/Home/Index">
                    <img src="~/images/logo1.png" alt="Job Connect Logo" />
                    <div class="brand-text">
                        <span class="main-text">JOB CONNECT</span>
                        <span class="sub-text">EST. 2024</span>
                    </div>
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                    faria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
              <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
    <!-- <ul class="navbar-nav" id="guest-menu">
        <li class="nav-item">
            <a class="nav-link" href="/Client/Home/Index">HOME</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Job/Index">JOBS</a>
        </li>
    </ul> -->

    <ul class="navbar-nav" id="candidate-nav" style="display: none;">
        <li class="nav-item">
            <a class="nav-link" href="/Client/Home/Index">HOME</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Home/CreateCV">CREATE CV</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Home/ApplyJobs">FIND JOBS</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Home/SavedJobs">SAVED JOBS</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Home/MyApplications">MY APPLICATIONS</a>
        </li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="candidate-name">Account</span>
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                <a class="dropdown-item" href="#">My Profile</a>
                <a class="dropdown-item" href="#">Settings</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#" id="logoutBtn">LOGOUT</a>
            </div>
        </li>
    </ul>

    <ul class="navbar-nav" id="recruiter-nav" style="display: none;">
        <li class="nav-item">
            <a class="nav-link" href="/Client/Recruiter/Dashboard">DASHBOARD</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Recruiter/CreateJob">CREATE JOB</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Recruiter/ManageJobs">MANAGE JOBS</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Client/Recruiter/Applications">APPLICATIONS</a>
        </li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="recruiterDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="recruiter-name">Company</span>
            </a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="recruiterDropdown">
                <a class="dropdown-item" href="/Client/Recruiter/CompanyProfile">Company Profile</a>
                <a class="dropdown-item" href="#">Settings</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#" id="recruiterLogoutBtn">LOGOUT</a>
            </div>
        </li>
    </ul>

    <!-- Nút đăng ký / đăng nhập (chỉ hiển thị khi chưa đăng nhập) -->
    <div class="d-flex ml-auto" id="auth-buttons">
        <button type="button" class="btn btn-auth" data-toggle="modal" data-target="#registerModal">REGISTER</button>
        <button type="button" class="btn btn-auth active" data-toggle="modal" data-target="#loginModal">LOGIN</button>
    </div>
</div>

            </div>
        </nav>
    </div>
        
    <div class="content">
        @RenderBody()
    </div>

    <div class="footer-gradient">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5>About Us</h5>
                    <p class="text-muted">Contact candidates to Recruiter efficiently.</p>
                </div>
                <div class="col-md-4">
                    <h5>Contact</h5>
                    <p class="text-muted">Email: contact@jobconnect.com</p>
                    <p class="text-muted">Phone: 123-456-7890</p>
                </div>
                <div class="col-md-4">
                    <h5>Follow</h5>
                    <div>
                        <a href="#" class="text-muted mr-3"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-muted mr-3"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-muted mr-3"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12 text-center">
                    <p class="text-muted mb-0">&copy; 2024 Job Connect. Đã đăng ký bản quyền.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="registerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registerModalLabel">Register Account</h5>
                    <button type="button" class="close" onclick="$('#registerModal').modal('hide');">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs mb-4" id="registerTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="candidate-tab" data-toggle="tab" href="#candidate" role="tab" aria-controls="candidate" aria-selected="true">Ứng Viên</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="recruiter-tab" data-toggle="tab" href="#recruiter" role="tab" aria-controls="recruiter" aria-selected="false">Nhà Tuyển Dụng</a>
                        </li>
                    </ul>
                    <div class="tab-content" id="registerTabContent">
                        <div class="tab-pane fade show active" id="candidate" role="tabpanel" aria-labelledby="candidate-tab">
                            <form id="candidateRegisterForm">
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="candidateName">Full Name</label>
                                        <input type="text" class="form-control" id="candidateName" placeholder="Enter your full name">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="candidateEmail">Email</label>
                                        <input type="email" class="form-control" id="candidateEmail" placeholder="Enter your email">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="candidatePhone">Phone Number</label>
                                        <input type="tel" class="form-control" id="candidatePhone" placeholder="Enter your phone number">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="candidateDOB">Date of Birth</label>
                                        <input type="date" class="form-control" id="candidateDOB">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="candidatePassword">Password</label>
                                        <input type="password" class="form-control" id="candidatePassword" placeholder="Enter your password">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="candidateConfirmPassword">Confirm Password</label>
                                        <input type="password" class="form-control" id="candidateConfirmPassword" placeholder="Enter your password again">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="candidateAddress">Address</label>
                                    <input type="text" class="form-control" id="candidateAddress" placeholder="Enter your address">
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="candidateTerms">
                                        <label class="custom-control-label" for="candidateTerms">Tôi đồng ý với <a href="#">điều khoản sử dụng</a> và <a href="#">chính sách bảo mật</a></label>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-center">
                                    <button type="submit" class="btn btn-primary px-5">REGISTER</button>
                                </div>
                            </form>
                        </div>
                        <div class="tab-pane fade" id="recruiter" role="tabpanel" aria-labelledby="recruiter-tab">
                            <form id="recruiterRegisterForm">
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="companyName">Company Name</label>
                                        <input type="text" class="form-control" id="companyName" placeholder="Enter your company name">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="businessType">Business Type</label>
                                        <select class="form-control" id="businessType">
                                            <option value="" selected disabled>Select business type</option>
                                            <option value="corporation">Corporation</option>
                                            <option value="limited">Limited Liability Company</option>
                                            <option value="private">Private enterprise</option>
                                            <option value="foreign">Foreign-invested enterprises</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="recruiterEmail">Company Email</label>
                                        <input type="email" class="form-control" id="recruiterEmail" placeholder="Enter your company email">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="recruiterPhone">Phone Number</label>
                                        <input type="tel" class="form-control" id="recruiterPhone" placeholder="Enter your phone number">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="recruiterPassword">Password</label>
                                        <input type="password" class="form-control" id="recruiterPassword" placeholder="Enter your password">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="recruiterConfirmPassword">Confirm Password</label>
                                        <input type="password" class="form-control" id="recruiterConfirmPassword" placeholder="Enter your password again">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="companyAddress">Company Address</label>
                                    <input type="text" class="form-control" id="companyAddress" placeholder="Enter your company address">
                                </div>
                                <div class="form-group">
                                    <label for="companyWebsite">Company Website</label>
                                    <input type="url" class="form-control" id="companyWebsite" placeholder="Enter your company website">
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="recruiterTerms">
                                        <label class="custom-control-label" for="recruiterTerms">I agree with<a href="#">terms of use</a> and <a href="#">privacy policy</a></label>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-center">
                                    <button type="submit" class="btn btn-primary px-5">Register</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Login</h5>
                    <button type="button" class="close" onclick="$('#loginModal').modal('hide');">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="loginEmail">Email</label>
                            <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email">
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password">
                        </div>
                        <div class="form-group form-check">
                            <input type="checkbox" class="form-check-input" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">Remember me</label>
                        </div>
                        <div class="form-group">
                            <div class="d-flex justify-content-between">
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" id="candidateType" name="userType" class="custom-control-input" value="candidate" checked>
                                    <label class="custom-control-label" for="candidateType">Candidate</label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" id="recruiterType" name="userType" class="custom-control-input" value="recruiter">
                                    <label class="custom-control-label" for="recruiterType">Recruiter</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-block py-2">Login</button>
                        </div>
                        <div class="text-center mt-3">
                            <a href="#" class="text-muted small">Forgot password?</a>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <p class="text-muted small mb-0">You don't have an account yet? <a href="javascript:void(0);" onclick="$('#loginModal').modal('hide'); $('#registerModal').modal('show');">Register now</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
    
    <script>
        // Kiểm tra ngay khi trang HTML được tải
        (function() {
            // Kiểm tra đăng nhập từ localStorage
            var isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            var userType = localStorage.getItem('userType');
            
            console.log("[Immediate check] isLoggedIn:", isLoggedIn, "userType:", userType);
            
            // Nếu đã đăng nhập với tư cách ứng viên, ẩn nút đăng nhập/đăng ký ngay lập tức
            if (isLoggedIn && userType === 'candidate') {
                document.body.classList.add('logged-in');
                console.log("[Immediate check] Added logged-in class to body");
                
                // Thử ẩn nút đăng nhập/đăng ký ngay lập tức
                var authButtons = document.getElementById('auth-buttons');
                if (authButtons) {
                    authButtons.style.display = 'none';
                    console.log("[Immediate check] Hidden auth-buttons");
                }
            }
        })();
    </script>
    
    <script>
        // Kiểm tra jQuery
        if (typeof jQuery != 'undefined') {
            console.log("jQuery is loaded! Version: " + jQuery.fn.jquery);
        } else {
            console.log("jQuery is not loaded!");
        }
        
        // Kiểm tra Bootstrap Modal
        if (typeof $.fn.modal != 'undefined') {
            console.log("Bootstrap Modal is loaded!");
        } else {
            console.log("Bootstrap Modal is not loaded!");
        }
        
        // Hàm đơn giản để kiểm tra trạng thái đăng nhập
        function checkIfLoggedIn() {
            var isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            console.log("[checkIfLoggedIn] Result:", isLoggedIn, "Raw value:", localStorage.getItem('isLoggedIn'));
            return isLoggedIn;
        }
        
        // Hàm đơn giản để kiểm tra loại người dùng
        function getUserType() {
            return localStorage.getItem('userType');
        }
        
        // Hàm đơn giản để lấy email người dùng
        function getUserEmail() {
            return localStorage.getItem('userEmail');
        }
        
        // Hàm chuyển đổi sang UI ứng viên
        function switchToCandidateUI() {
            console.log("[switchToCandidateUI] Starting UI change");
            
            // Thêm class logged-in vào body để kích hoạt CSS
            $('body').addClass('logged-in');
            $('body').removeClass('recruiter-logged-in');
            
            // Cập nhật UI trực tiếp
            $('#guest-menu').hide();
            $('#candidate-nav').show();
            $('#recruiter-nav').hide();
            
            // Ẩn nút đăng nhập/đăng ký
            $('#auth-buttons').hide();
            
            // Cập nhật tên người dùng
            var email = getUserEmail();
            $('.candidate-name').text(email || 'Candidate');
            
            // Hiển thị dashboard nếu ở trang chủ
            if ($('#candidate-dashboard').length > 0) {
                $('#guest-content').hide();
                $('#candidate-dashboard').show();
            }
            
            console.log("[switchToCandidateUI] Completed, auth-buttons visible =", $('#auth-buttons').is(':visible'), "Display:", $('#auth-buttons').css('display'));
        }
        
        // Hàm chuyển đổi sang UI nhà tuyển dụng
        function switchToRecruiterUI() {
            console.log("[switchToRecruiterUI] Starting UI change");
            
            // Thêm class recruiter-logged-in vào body để kích hoạt CSS
            $('body').addClass('recruiter-logged-in');
            $('body').removeClass('logged-in');
            
            // Cập nhật UI trực tiếp
            $('#guest-menu').hide();
            $('#candidate-nav').hide();
            $('#recruiter-nav').show();
            
            // Ẩn nút đăng nhập/đăng ký
            $('#auth-buttons').hide();
            
            // Cập nhật tên công ty
            var email = getUserEmail();
            $('.recruiter-name').text(email || 'Company');
            
            console.log("[switchToRecruiterUI] Completed");
        }
        
        // Hàm chuyển đổi sang UI khách
        function switchToGuestUI() {
            console.log("[switchToGuestUI] Starting UI change");
            
            // Xóa class logged-in từ body
            $('body').removeClass('logged-in');
            $('body').removeClass('recruiter-logged-in');
            
            // Cập nhật UI trực tiếp
            $('#guest-menu').show();
            $('#candidate-nav').hide();
            $('#recruiter-nav').hide();
            $('#auth-buttons').show();
            
            // Hiển thị nội dung chung nếu ở trang chủ
            if ($('#guest-content').length > 0) {
                $('#guest-content').show();
                $('#candidate-dashboard').hide();
            }
            
            console.log("[switchToGuestUI] Completed");
        }
        
        $(document).ready(function() {
            console.log("[document.ready] Starting...");
            
            // Kiểm tra trạng thái đăng nhập ngay khi trang tải
            var isLoggedIn = checkIfLoggedIn();
            var userType = getUserType();
            
            console.log("[document.ready] Auth state:", isLoggedIn, userType);
            console.log("[document.ready] auth-buttons display:", $('#auth-buttons').css('display'));
            
            if (isLoggedIn && userType === 'candidate') {
                console.log("[document.ready] Logged in as candidate, switching UI");
                switchToCandidateUI();
            } else if (isLoggedIn && userType === 'recruiter') {
                console.log("[document.ready] Logged in as recruiter, switching UI");
                switchToRecruiterUI();
                if (window.location.pathname.indexOf('/Client/Recruiter') === -1) {
                    // Chuyển hướng đến trang recruiter nếu chưa ở đó
                    window.location.href = '/Client/Recruiter/Dashboard';
                }
            } else {
                // Nếu chưa đăng nhập hoặc không phải candidate/recruiter
                switchToGuestUI();
            }
            
            // Xử lý sự kiện đóng modal
            $('.modal .close, .modal').on('click', function(e) {
                if ($(e.target).hasClass('modal') || $(e.target).hasClass('close') || $(e.target).parent().hasClass('close')) {
                    $('.modal').modal('hide');
                }
            });
            
            // Xử lý đăng ký candidate
            $('#candidateRegisterForm').on('submit', function(e) {
                e.preventDefault();
                
                // Kiểm tra mật khẩu
                if ($('#candidatePassword').val() !== $('#candidateConfirmPassword').val()) {
                    alert('Mật khẩu không khớp!');
                    return;
                }
                
                console.log("[candidateRegister] Setting localStorage...");
                
                // Lưu thông tin đăng nhập
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('userType', 'candidate');
                localStorage.setItem('userEmail', $('#candidateEmail').val());
                
                console.log("[candidateRegister] LocalStorage set:", 
                            "isLoggedIn=", localStorage.getItem('isLoggedIn'),
                            "userType=", localStorage.getItem('userType'));
                
                // Đóng modal và hiển thị thông báo
                $('#registerModal').modal('hide');
                alert('Đăng ký tài khoản ứng viên thành công!');
                
                // Chuyển đổi UI
                switchToCandidateUI();
            });
            
            // Xử lý đăng ký recruiter
            $('#recruiterRegisterForm').on('submit', function(e) {
                e.preventDefault();
                
                // Kiểm tra mật khẩu
                if ($('#recruiterPassword').val() !== $('#recruiterConfirmPassword').val()) {
                    alert('Mật khẩu không khớp!');
                    return;
                }
                
                // Lưu thông tin đăng nhập
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('userType', 'recruiter');
                localStorage.setItem('userEmail', $('#recruiterEmail').val());
                
                // Đóng modal và hiển thị thông báo
                $('#registerModal').modal('hide');
                alert('Đăng ký tài khoản nhà tuyển dụng thành công! Chúng tôi sẽ xác minh thông tin và liên hệ lại.');
                
                // Chuyển hướng đến trang recruiter
                window.location.href = '/Client/Recruiter/Dashboard';
            });
            
            // Xử lý đăng nhập
            $('#loginForm').on('submit', function(e) {
                e.preventDefault();
                
                // Lấy thông tin đăng nhập
                var userType = $('input[name="userType"]:checked').val();
                var userEmail = $('#loginEmail').val();
                
                console.log("[login] Form submitted with:", userType, userEmail);
                
                // Lưu thông tin đăng nhập
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('userType', userType);
                localStorage.setItem('userEmail', userEmail);
                
                console.log("[login] LocalStorage set:", 
                            "isLoggedIn=", localStorage.getItem('isLoggedIn'),
                            "userType=", localStorage.getItem('userType'));
                
                // Đóng modal
                $('#loginModal').modal('hide');
                
                // Xử lý dựa trên loại người dùng
                if (userType === 'recruiter') {
                    window.location.href = '/Client/Recruiter/Dashboard';
                } else {
                    console.log("[login] Auth buttons before switchToCandidateUI:", $('#auth-buttons').is(':visible'));
                    switchToCandidateUI();
                    console.log("[login] Auth buttons after switchToCandidateUI:", $('#auth-buttons').is(':visible'));
                    alert('Đăng nhập ứng viên thành công!');
                }
            });
            
            // Xử lý đăng xuất
            $('#logoutBtn, #recruiterLogoutBtn').on('click', function(e) {
                e.preventDefault();
                
                // Xóa thông tin đăng nhập
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('userType');
                localStorage.removeItem('userEmail');
                
                // Chuyển đổi UI
                switchToGuestUI();
                
                alert('Đăng xuất thành công!');
                
                // Chuyển hướng về trang chủ
                window.location.href = '/Client/Home/Index';
            });
        });
    </script>
    
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
