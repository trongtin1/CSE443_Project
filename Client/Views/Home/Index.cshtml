@using System.Linq
@using Microsoft.AspNetCore.Http
@{
    ViewData["Title"] = "Home";
}

@section Styles {
    <link href="~/css/home.css" rel="stylesheet" />
}

<!-- Hero Section -->
<section class="hero-section bg-gradient-primary text-white py-5 rounded-4 position-relative overflow-hidden">
    <div class="hero-background"></div>
    <div class="container position-relative">
        <div class="row align-items-center min-vh-50">
            <div class="col-lg-6">
                <div class="hero-content">
                    <span class="badge hero-badge bg-white text-primary mb-3 px-3 py-2">
                        <i class="fas fa-star me-2"></i>Trusted by 10,000+ Job Seekers
                    </span>
                    <h1 class="display-3 fw-bold mb-4 hero-title">
                        Find Your
                        <span class="text-warning">Dream Job</span>
                        Today
                    </h1>
                    <p class="lead mb-4 fs-5 text-light">
                        Connect with top employers and discover career opportunities that match your skills and
                        aspirations.
                        Your perfect job is just a click away!
                    </p>
                    <div class="hero-stats row text-center mb-4">
                        <div class="col-4">
                            <div class="stat-item">
                                <h3 class="fw-bold mb-1">5000+</h3>
                                <small class="text-light">Active Jobs</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="stat-item">
                                <h3 class="fw-bold mb-1">500+</h3>
                                <small class="text-light">Companies</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="stat-item">
                                <h3 class="fw-bold mb-1">10k+</h3>
                                <small class="text-light">Job Seekers</small>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex flex-wrap gap-3">
                        <a asp-controller="Job" asp-action="Index" class="btn btn-warning btn-lg px-4 py-3 fw-semibold">
                            <i class="fas fa-search me-2"></i>Explore Jobs
                        </a>
                        @if (Context.Session.GetInt32("JobSeekerId") == null &&
                                                Context.Session.GetInt32("EmployerId") == null)
                        {
                            <a asp-controller="User" asp-action="Register"
                                class="btn btn-outline-light btn-lg px-4 py-3 fw-semibold">
                                <i class="fas fa-user-plus me-2"></i>Join Now
                            </a>
                        }
                    </div>
                </div>
            </div>
            <div class="col-lg-6 d-none d-lg-block">
                <div class="hero-image text-center">
                    <img src="~/images/logo.png" alt="Job Search" class="img-fluid hero-logo" />
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Advanced Search Section -->
<section class="search-section bg-white shadow-lg rounded-4 p-4 my-5 position-relative">
    <div class="container">
        <div class="text-center mb-4">
            <h3 class="fw-bold text-dark mb-2">Start Your Job Search</h3>
            <p class="text-muted">Use our advanced search to find the perfect job for you</p>
        </div>
        <form asp-controller="Job" asp-action="Index" method="get" class="search-form">
            <div class="row g-3 align-items-end">
                <div class="col-lg-4 col-md-12">
                    <label class="form-label fw-semibold text-dark">
                        <i class="fas fa-search text-primary me-2"></i>What
                    </label>
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="fas fa-briefcase text-primary"></i>
                        </span>
                        <input type="text" name="searchTerm" class="form-control border-start-0 ps-0"
                            placeholder="Job title, skills, or company name">
                    </div>
                </div>
                <div class="col-lg-3 col-md-12">
                    <label class="form-label fw-semibold text-dark">
                        <i class="fas fa-map-marker-alt text-primary me-2"></i>Where
                    </label>
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="fas fa-location-dot text-primary"></i>
                        </span>
                        <input type="text" name="location" class="form-control border-start-0 ps-0"
                            placeholder="City, state, or remote">
                    </div>
                </div>
                <div class="col-lg-2 col-md-6">
                    <label class="form-label fw-semibold text-dark">
                        <i class="fas fa-filter text-primary me-2"></i>Type
                    </label>
                    <select name="jobType" class="form-select form-select-lg">
                        <option value="">All Types</option>
                        <option value="Full-time">Full-time</option>
                        <option value="Part-time">Part-time</option>
                        <option value="Contract">Contract</option>
                        <option value="Internship">Internship</option>
                    </select>
                </div>
                <div class="col-lg-3 col-md-6">
                    <button type="submit" class="btn btn-primary btn-lg w-100 fw-semibold py-3">
                        <i class="fas fa-search me-2"></i>Search Jobs
                    </button>
                </div>
            </div>
        </form>

        <!-- Quick Search Tags -->
        <div class="mt-4">
            <p class="text-muted small mb-2">Popular searches:</p>
            <div class="d-flex flex-wrap gap-2">
                <span class="badge bg-light text-dark px-3 py-2 quick-tag">Software Engineer</span>
                <span class="badge bg-light text-dark px-3 py-2 quick-tag">Data Scientist</span>
                <span class="badge bg-light text-dark px-3 py-2 quick-tag">Marketing Manager</span>
                <span class="badge bg-light text-dark px-3 py-2 quick-tag">Remote Jobs</span>
                <span class="badge bg-light text-dark px-3 py-2 quick-tag">Senior Developer</span>
            </div>
        </div>
    </div>
</section>

<!-- Latest Jobs Section -->
<section class="latest-jobs-section my-5 py-5">
    <div class="container">
        <div class="section-header text-center mb-5">
            <span class="badge bg-primary bg-opacity-10 text-primary px-3 py-2 mb-3">
                <i class="fas fa-fire me-2"></i>Hot Jobs
            </span>
            <h2 class="display-5 fw-bold text-dark mb-3">Latest Job Opportunities</h2>
            <p class="text-muted fs-5 mx-auto" style="max-width: 600px;">
                Discover the newest positions from top companies actively hiring talented professionals
            </p>
        </div>

        @{
            var latestJobs = ViewBag.LatestJobs as System.Collections.IEnumerable;
            var jobsList = latestJobs != null ? latestJobs.Cast<dynamic>().Take(12).ToList() : new List<dynamic>();
        }

        @if (jobsList.Count > 6)
        {
            <!-- Carousel for many jobs -->
            <div id="latestJobsCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    @for (int i = 0; i < jobsList.Count; i += 6)
                    {
                        <div class="carousel-item @(i == 0 ? "active" : "")">
                            <div class="row g-4">
                                @for (int j = i; j < Math.Min(i + 6, jobsList.Count); j++)
                                {
                                    var job = jobsList[j];
                                    <div class="col-md-6 col-lg-4">
                                        <div class="card h-100 border-0 shadow-sm job-card">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between mb-3">
                                                    <span
                                                        class="badge bg-@(job.JobType == "Full-time" ? "success" : 
                                                                                                                                                                                           job.JobType == "Part-time" ? "info" : 
                                                                                                                                                                                           job.JobType == "Contract" ? "warning" : 
                                                                                                                                                                                           job.JobType == "Internship" ? "secondary" : "primary")">
                                            @job.JobType
                                        </span>
                                        <span class="text-muted small">
                                            <i class="fas fa-clock me-1"></i>
                                            @((DateTime.Now - job.CreatedAt).Days) days ago
                                        </span>
                                    </div>
                                    <h5 class="card-title mb-1">
                                        <a asp-controller="Job" asp-action="Details" asp-route-id="@job.Id"
                                            class="text-decoration-none text-dark job-title">
                                            @job.JobTitle
                                        </a>
                                    </h5>
                                    <p class="text-muted mb-2">@job.Employer.CompanyName</p>
                                    <div class="mb-3">
                                        <i class="fas fa-map-marker-alt text-muted me-1"></i> @job.Location
                                        @if (job.IsRemote)
                                                    {
                                                        <span class="ms-2 badge bg-light text-dark">Remote</span>
                                                    }
                                            </div>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span class="fw-bold text-primary">
                                                    @(job.SalaryMin > 0 && job.SalaryMax > 0 ?
                                                                                                $"${job.SalaryMin:N0} - ${job.SalaryMax:N0}" :
                                                                                                "Competitive")
                                        </span>
                                        <a asp-controller="Job" asp-action="Details" asp-route-id="@job.Id"
                                            class="btn btn-sm btn-outline-primary">
                                            View Job
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                                                }
                            </div>
                        </div>
                    }
                </div>

                @if (jobsList.Count > 6)
                {
                    <button class="carousel-control-prev" type="button" data-bs-target="#latestJobsCarousel"
                        data-bs-slide="prev">
                        <span class="carousel-control-prev-icon bg-primary rounded-circle" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#latestJobsCarousel"
                        data-bs-slide="next">
                        <span class="carousel-control-next-icon bg-primary rounded-circle" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                }
            </div>
        }
        else
        {
            <!-- Regular grid for fewer jobs -->
            <div class="row g-4">
                @foreach (var job in jobsList)
                {
                    <div class="col-md-6 col-lg-4">
                        <div class="card h-100 border-0 shadow-sm job-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-3">
                                    <span
                                        class="badge bg-@(job.JobType == "Full-time" ? "success" : 
                                                                                                                                             job.JobType == "Part-time" ? "info" : 
                                                                                                                                             job.JobType == "Contract" ? "warning" : 
                                                                                                                                             job.JobType == "Internship" ? "secondary" : "primary")">
                                @job.JobType
                            </span>
                            <span class="text-muted small">
                                <i class="fas fa-clock me-1"></i>
                                @((DateTime.Now - job.CreatedAt).Days) days ago
                            </span>
                        </div>
                        <h5 class="card-title mb-1">
                            <a asp-controller="Job" asp-action="Details" asp-route-id="@job.Id"
                                class="text-decoration-none text-dark job-title">
                                @job.JobTitle
                            </a>
                        </h5>
                        <p class="text-muted mb-2">@job.Employer.CompanyName</p>
                        <div class="mb-3">
                            <i class="fas fa-map-marker-alt text-muted me-1"></i> @job.Location
                            @if (job.IsRemote)
                                    {
                                        <span class="ms-2 badge bg-light text-dark">Remote</span>
                                    }
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-primary">
                                    @(job.SalaryMin > 0 && job.SalaryMax > 0 ?
                                                                    $"${job.SalaryMin:N0} - ${job.SalaryMax:N0}" :
                                                                    "Competitive")
                            </span>
                            <a asp-controller="Job" asp-action="Details" asp-route-id="@job.Id"
                                class="btn btn-sm btn-outline-primary">
                                View Job
                            </a>
                        </div>
                    </div>
                </div>

                    </div>
                        }
            </div>
        }
        <div class="text-center mt-4">
            <a asp-controller="Job" asp-action="Index" class="btn btn-outline-primary">View All Jobs</a>
        </div>
    </div>
</section>

<!-- Job Categories Section -->
<section class="categories-section my-5 py-5 bg-light rounded-4">
    <div class="container">
        <div class="section-header text-center mb-5">
            <span class="badge bg-success bg-opacity-10 text-success px-3 py-2 mb-3">
                <i class="fas fa-tags me-2"></i>Categories
            </span>
            <h2 class="display-5 fw-bold text-dark mb-3">Explore by Category</h2>
            <p class="text-muted fs-5 mx-auto" style="max-width: 600px;">
                Find your ideal career path by browsing through our diverse range of job categories
            </p>
        </div>

        @{
            var categoryList = ViewBag.Categories as System.Collections.IEnumerable;
            var displayCategories = categoryList != null ? categoryList.Cast<dynamic>().Take(16).ToList() : new
            List<dynamic>();
        }

        @if (displayCategories.Count > 8)
        {
            <!-- Tabs for many categories -->
            <ul class="nav nav-pills justify-content-center mb-4" id="categoryTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="categories-tab-1" data-bs-toggle="pill"
                        data-bs-target="#categories-1" type="button" role="tab">
                        Popular
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="categories-tab-2" data-bs-toggle="pill" data-bs-target="#categories-2"
                        type="button" role="tab">
                        More Categories
                    </button>
                </li>
            </ul>

            <div class="tab-content" id="categoryTabsContent">
                <div class="tab-pane fade show active" id="categories-1" role="tabpanel">
                    <div class="row g-4">
                        @for (int i = 0; i < Math.Min(8, displayCategories.Count); i++)
                        {
                            var category = displayCategories[i];
                            <div class="col-md-3 col-sm-6">
                                <a asp-controller="Job" asp-action="ByCategory" asp-route-id="@category.Id"
                                    class="text-decoration-none">
                                    <div class="card border-0 shadow-sm h-100 text-center hover-card category-card">
                                        <div class="card-body py-4">
                                            <div class="category-icon mb-3">
                                                <i class="fas @category.Icon fa-2x text-primary"></i>
                                            </div>
                                            <h5 class="card-title">@category.Name</h5>
                                            <p class="text-muted mb-0">
                                                @ViewData[$"JobCount_{category.Id}"] Jobs Available
                                            </p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        }
                    </div>
                </div>

                @if (displayCategories.Count > 8)
                {
                    <div class="tab-pane fade" id="categories-2" role="tabpanel">
                        <div class="row g-4">
                            @for (int i = 8; i < displayCategories.Count; i++)
                            {
                                var category = displayCategories[i];
                                <div class="col-md-3 col-sm-6">
                                    <a asp-controller="Job" asp-action="ByCategory" asp-route-id="@category.Id"
                                        class="text-decoration-none">
                                        <div class="card border-0 shadow-sm h-100 text-center hover-card category-card">
                                            <div class="card-body py-4">
                                                <div class="category-icon mb-3">
                                                    <i class="fas @category.Icon fa-2x text-primary"></i>
                                                </div>
                                                <h5 class="card-title">@category.Name</h5>
                                                <p class="text-muted mb-0">
                                                    @ViewData[$"JobCount_{category.Id}"] Jobs Available
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            }
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <!-- Regular grid for fewer categories -->
            <div class="row g-4">
                @foreach (var category in displayCategories)
                {
                    <div class="col-md-3 col-sm-6">
                        <a asp-controller="Job" asp-action="ByCategory" asp-route-id="@category.Id"
                            class="text-decoration-none">
                            <div class="card border-0 shadow-sm h-100 text-center hover-card category-card">
                                <div class="card-body py-4">
                                    <div class="category-icon mb-3">
                                        <i class="fas @category.Icon fa-2x text-primary"></i>
                                    </div>
                                    <h5 class="card-title">@category.Name</h5>
                                    <p class="text-muted mb-0">
                                        @ViewData[$"JobCount_{category.Id}"] Jobs Available
                                    </p>
                                </div>
                            </div>
                        </a>
                    </div>
                }
            </div>
        }

        <div class="text-center mt-4">
            <a asp-controller="Category" asp-action="Index" class="btn btn-outline-primary">View All Categories</a>
        </div>
    </div>
</section>

<!-- Featured Employers Section -->
<section class="my-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="mb-3">Featured Employers</h2>
            <p class="text-muted">Top companies that trust our platform for their hiring needs</p>
        </div>

        @{
            var featuredEmployers = ViewBag.FeaturedEmployers as System.Collections.IEnumerable;
            var employersList = featuredEmployers != null ? featuredEmployers.Cast<dynamic>().Take(12).ToList() : new
            List<dynamic>();
        }

        @if (employersList.Count > 8)
        {
            <!-- Carousel for many employers -->
            <div id="employersCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    @for (int i = 0; i < employersList.Count; i += 8)
                    {
                        <div class="carousel-item @(i == 0 ? "active" : "")">
                            <div class="row g-4">
                                @for (int j = i; j < Math.Min(i + 8, employersList.Count); j++)
                                {
                                    var employer = employersList[j];
                                    <div class="col-md-3 col-sm-6">
                                        <div class="card border-0 shadow-sm h-100 text-center employer-card">
                                            <div class="card-body p-4">
                                                <div class="employer-logo mb-3">
                                                    @if (!string.IsNullOrEmpty(employer.Logo))
                                                    {
                                                        <img src="@employer.Logo" alt="@employer.CompanyName"
                                                            class="img-fluid employer-logo-img"
                                                            style="max-height: 60px; max-width: 120px; object-fit: contain;">
                                                    }
                                                    else
                                                    {
                                                        <div class="bg-primary text-white rounded d-flex align-items-center justify-content-center"
                                                            style="height: 60px; width: 120px; margin: 0 auto;">
                                                            <i class="fas fa-building fa-2x"></i>
                                                        </div>
                                                    }
                                                </div>
                                                <h5 class="card-title employer-name">@employer.CompanyName</h5>
                                                <p class="text-muted mb-3 small">@employer.Industry</p>
                                                <a asp-controller="Job" asp-action="ByEmployer" asp-route-id="@employer.Id"
                                                    class="btn btn-sm btn-outline-primary">
                                                    View Jobs
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    }
                </div>

                @if (employersList.Count > 8)
                {
                    <button class="carousel-control-prev" type="button" data-bs-target="#employersCarousel"
                        data-bs-slide="prev">
                        <span class="carousel-control-prev-icon bg-primary rounded-circle" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#employersCarousel"
                        data-bs-slide="next">
                        <span class="carousel-control-next-icon bg-primary rounded-circle" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                }

                <!-- Indicators for better navigation -->
                @if (employersList.Count > 8)
                {
                    <div class="carousel-indicators position-relative mt-4">
                        @for (int i = 0; i < Math.Ceiling((double)employersList.Count / 8); i++)
                        {
                            <button type="button" data-bs-target="#employersCarousel" data-bs-slide-to="@i"
                                class="@(i == 0 ? "active" : "")" aria-label="Slide @(i + 1)"></button>
                        }
                    </div>
                }
            </div>
        }
        else
        {
            <!-- Regular grid for fewer employers -->
            <div class="row g-4">
                @foreach (var employer in employersList)
                {
                    <div class="col-md-3 col-sm-6">
                        <div class="card border-0 shadow-sm h-100 text-center employer-card">
                            <div class="card-body p-4">
                                <div class="employer-logo mb-3">
                                    @if (!string.IsNullOrEmpty(employer.Logo))
                                    {
                                        <img src="@employer.Logo" alt="@employer.CompanyName" class="img-fluid employer-logo-img"
                                            style="max-height: 60px; max-width: 120px; object-fit: contain;">
                                    }
                                    else
                                    {
                                        <div class="bg-primary text-white rounded d-flex align-items-center justify-content-center"
                                            style="height: 60px; width: 120px; margin: 0 auto;">
                                            <i class="fas fa-building fa-2x"></i>
                                        </div>
                                    }
                                </div>
                                <h5 class="card-title employer-name">@employer.CompanyName</h5>
                                <p class="text-muted mb-3 small">@employer.Industry</p>
                                <a asp-controller="Job" asp-action="ByEmployer" asp-route-id="@employer.Id"
                                    class="btn btn-sm btn-outline-primary">
                                    View Jobs
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
</section>

<!-- Call to Action Section -->
<section class="cta-section bg-gradient-primary text-white rounded-4 my-5 position-relative overflow-hidden">
    <div class="cta-background"></div>
    <div class="container position-relative py-5">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <div class="cta-content">
                    <span class="badge bg-white text-primary px-3 py-2 mb-3 fw-semibold">
                        <i class="fas fa-bullhorn me-2"></i>For Employers
                    </span>
                    <h2 class="display-6 fw-bold mb-3">Ready to Find Your Next Star Employee?</h2>
                    <p class="lead mb-0 fs-5 text-light">
                        Join thousands of successful companies using our platform to discover and hire top talent.
                        Post your job today and connect with qualified candidates immediately.
                    </p>
                    <div class="mt-4">
                        <div class="row text-center">
                            <div class="col-4">
                                <div class="cta-stat">
                                    <h4 class="fw-bold mb-1">24hrs</h4>
                                    <small class="text-light">Avg. Time to Hire</small>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="cta-stat">
                                    <h4 class="fw-bold mb-1">95%</h4>
                                    <small class="text-light">Success Rate</small>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="cta-stat">
                                    <h4 class="fw-bold mb-1">500+</h4>
                                    <small class="text-light">Companies Trust Us</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 text-lg-end mt-4 mt-lg-0">
                <div class="cta-buttons">
                    @if (Context.Session.GetInt32("EmployerId") != null)
                    {
                        <a asp-controller="Job" asp-action="Create"
                            class="btn btn-warning btn-lg px-4 py-3 fw-semibold mb-3 d-block">
                            <i class="fas fa-plus me-2"></i>Post a Job Now
                        </a>
                        <a asp-controller="Employer" asp-action="Dashboard"
                            class="btn btn-outline-light btn-lg px-4 py-3 fw-semibold d-block">
                            <i class="fas fa-chart-bar me-2"></i>View Dashboard
                        </a>
                    }
                    else if (Context.Session.GetInt32("JobSeekerId") != null)
                    {
                        <a asp-controller="JobSeeker" asp-action="Applications"
                            class="btn btn-warning btn-lg px-4 py-3 fw-semibold mb-3 d-block">
                            <i class="fas fa-clipboard-list me-2"></i>My Applications
                        </a>
                        <a asp-controller="JobSeeker" asp-action="Profile"
                            class="btn btn-outline-light btn-lg px-4 py-3 fw-semibold d-block">
                            <i class="fas fa-user me-2"></i>Update Profile
                        </a>
                    }
                    else
                    {
                        <a asp-controller="User" asp-action="Register"
                            class="btn btn-warning btn-lg px-4 py-3 fw-semibold mb-3 d-block">
                            <i class="fas fa-building me-2"></i>Register as Employer
                        </a>
                        <a asp-controller="User" asp-action="Register"
                            class="btn btn-outline-light btn-lg px-4 py-3 fw-semibold d-block">
                            <i class="fas fa-user-tie me-2"></i>Join as Job Seeker
                        </a>
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section class="my-5">
    <div class="container">
        <div class="text-center mb-5">
            @if (Context.Session.GetInt32("JobSeekerId") == null && Context.Session.GetInt32("EmployerId") ==
                        null)
            {
                <h2 class="mb-3">How It Works</h2>
                <p class="text-muted">Simple steps to start your job search or hiring process</p>
            }
            else
            {
                <h2 class="mb-3">Get the Most Out of JobPortal</h2>
                <p class="text-muted">Maximize your experience with these helpful features</p>
            }
        </div>

        <div class="row g-4">
            @if (Context.Session.GetInt32("JobSeekerId") == null && Context.Session.GetInt32("EmployerId") ==
                        null)
            {
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-user-plus fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">1. Create an Account</h4>
                            <p class="text-muted">Register as a job seeker or employer to access all features.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-file-alt fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">2. Complete Your Profile</h4>
                            <p class="text-muted">Create your CV or company profile to stand out.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-handshake fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">3. Apply or Post Jobs</h4>
                            <p class="text-muted">Apply to jobs or post openings and connect with the right people.</p>
                        </div>
                    </div>
                </div>
            }
            else if (Context.Session.GetInt32("JobSeekerId") != null)
            {
                <!-- Features for Job Seekers -->
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-search fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">Find Jobs</h4>
                            <p class="text-muted">Search and filter jobs that match your skills and preferences.</p>
                            <a asp-controller="Job" asp-action="Index" class="btn btn-outline-primary mt-2">Browse Jobs</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-file-alt fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">Manage Your CVs</h4>
                            <p class="text-muted">Create and update your CVs to showcase your skills and experience.</p>
                            <a asp-controller="JobSeeker" asp-action="CVs" class="btn btn-outline-primary mt-2">My CVs</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-bookmark fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">Saved Jobs</h4>
                            <p class="text-muted">Keep track of jobs you're interested in and apply when ready.</p>
                            <a asp-controller="JobSeeker" asp-action="SavedJobs" class="btn btn-outline-primary mt-2">View
                                Saved Jobs</a>
                        </div>
                    </div>
                </div>
            }
            else if (Context.Session.GetInt32("EmployerId") != null)
            {
                <!-- Features for Employers -->
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-plus-circle fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">Post Jobs</h4>
                            <p class="text-muted">Create and publish job listings to attract qualified candidates.</p>
                            <a asp-controller="Job" asp-action="Create" class="btn btn-outline-primary mt-2">Post a Job</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-tasks fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">Manage Applications</h4>
                            <p class="text-muted">Review and process applications from job seekers.</p>
                            <a asp-controller="Employer" asp-action="Applications" class="btn btn-outline-primary mt-2">View
                                Applications</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0 shadow-sm h-100 text-center">
                        <div class="card-body p-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-users fa-3x text-primary"></i>
                            </div>
                            <h4 class="card-title">Shortlisted Candidates</h4>
                            <p class="text-muted">Manage your shortlisted candidates for interviews and hiring.</p>
                            <a asp-controller="Employer" asp-action="Candidates" class="btn btn-outline-primary mt-2">View
                                Candidates</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section class="testimonials-section my-5 py-5">
    <div class="container">
        <div class="section-header text-center mb-5">
            <span class="badge bg-warning bg-opacity-10 text-warning px-3 py-2 mb-3">
                <i class="fas fa-star me-2"></i>Success Stories
            </span>
            <h2 class="display-5 fw-bold text-dark mb-3">What Our Users Say</h2>
            <p class="text-muted fs-5 mx-auto" style="max-width: 600px;">
                Real testimonials from job seekers and employers who found success through our platform
            </p>
        </div>

        <div class="row g-4">
            <div class="col-lg-4">
                <div class="testimonial-card card border-0 shadow-sm h-100">
                    <div class="card-body p-4">
                        <div class="d-flex mb-3">
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning"></i>
                        </div>
                        <p class="text-muted mb-4 fst-italic">
                            "I found my dream job within 2 weeks of signing up. The platform is incredibly user-friendly
                            and the job matching is spot on!"
                        </p>
                        <div class="d-flex align-items-center">
                            <div class="avatar me-3">
                                <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center"
                                    style="width: 50px; height: 50px;">
                                    <i class="fas fa-user text-white"></i>
                                </div>
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold">Sarah Johnson</h6>
                                <small class="text-muted">Software Engineer</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="testimonial-card card border-0 shadow-sm h-100">
                    <div class="card-body p-4">
                        <div class="d-flex mb-3">
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning"></i>
                        </div>
                        <p class="text-muted mb-4 fst-italic">
                            "As an employer, this platform helped us find qualified candidates quickly. The talent pool
                            is impressive and diverse."
                        </p>
                        <div class="d-flex align-items-center">
                            <div class="avatar me-3">
                                <div class="bg-success rounded-circle d-flex align-items-center justify-content-center"
                                    style="width: 50px; height: 50px;">
                                    <i class="fas fa-building text-white"></i>
                                </div>
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold">Michael Chen</h6>
                                <small class="text-muted">HR Director, TechCorp</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="testimonial-card card border-0 shadow-sm h-100">
                    <div class="card-body p-4">
                        <div class="d-flex mb-3">
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning me-1"></i>
                            <i class="fas fa-star text-warning"></i>
                        </div>
                        <p class="text-muted mb-4 fst-italic">
                            "The career guidance and job recommendations helped me transition to a better career path.
                            Highly recommended!"
                        </p>
                        <div class="d-flex align-items-center">
                            <div class="avatar me-3">
                                <div class="bg-info rounded-circle d-flex align-items-center justify-content-center"
                                    style="width: 50px; height: 50px;">
                                    <i class="fas fa-user text-white"></i>
                                </div>
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold">Emily Rodriguez</h6>
                                <small class="text-muted">Marketing Manager</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Stats Section -->
<section class="stats-section bg-gradient-primary text-white py-5 rounded-4 my-5">
    <div class="container">
        <div class="row text-center">
            <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">
                <div class="stat-item">
                    <div class="stat-icon mb-3">
                        <i class="fas fa-briefcase fa-2x"></i>
                    </div>
                    <h3 class="fw-bold mb-2 counter" data-target="5000">@ViewBag.ActiveJobs</h3>
                    <p class="mb-0 text-light">Active Jobs</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">
                <div class="stat-item">
                    <div class="stat-icon mb-3">
                        <i class="fas fa-users fa-2x"></i>
                    </div>
                    <h3 class="fw-bold mb-2 counter" data-target="10000">@ViewBag.JobSeekers</h3>
                    <p class="mb-0 text-light">Job Seekers</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">
                <div class="stat-item">
                    <div class="stat-icon mb-3">
                        <i class="fas fa-building fa-2x"></i>
                    </div>
                    <h3 class="fw-bold mb-2 counter" data-target="500">@ViewBag.Companies</h3>
                    <p class="mb-0 text-light">Companies</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-item">
                    <div class="stat-icon mb-3">
                        <i class="fas fa-handshake fa-2x"></i>
                    </div>
                    <h3 class="fw-bold mb-2 counter" data-target="2500">@ViewBag.SuccessfulHires</h3>
                    <p class="mb-0 text-light">Successful Hires</p>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Initialize carousels with custom settings
            $('#latestJobsCarousel').carousel({
                interval: 5000,
                wrap: true,
                touch: true
            });

            $('#employersCarousel').carousel({
                interval: 4000,
                wrap: true,
                touch: true
            });

            // Add loading states for better UX
            $('.carousel').on('slide.bs.carousel', function () {
                $(this).find('.carousel-item.active').addClass('loading-placeholder');
            });

            $('.carousel').on('slid.bs.carousel', function () {
                $(this).find('.carousel-item').removeClass('loading-placeholder');
            });

            // Lazy loading for images
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.classList.remove('lazy');
                            imageObserver.unobserve(img);
                        }
                    });
                });

                document.querySelectorAll('img[data-src]').forEach(img => {
                    imageObserver.observe(img);
                });
            }

            // Add keyboard navigation for carousels
            $(document).keydown(function (e) {
                if (e.which === 37) { // Left arrow
                    $('.carousel').carousel('prev');
                } else if (e.which === 39) { // Right arrow
                    $('.carousel').carousel('next');
                }
            });

            // Auto-pause carousel on hover
            $('.carousel').hover(
                function () { $(this).carousel('pause'); },
                function () { $(this).carousel('cycle'); }
            );
            // Add smooth scrolling for category tabs
            $('button[data-bs-toggle="pill"]').on('shown.bs.tab', function (e) {
                $('html, body').animate({
                    scrollTop: $('#categoryTabs').offset().top - 100
                }, 300);
            });

            // Initialize tooltips
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });

            // Counter animation for stats section
            function animateCounters() {
                $('.counter').each(function () {
                    const $this = $(this);
                    const countTo = parseInt($this.attr('data-target'));

                    $({ countNum: 0 }).animate({
                        countNum: countTo
                    }, {
                        duration: 2000,
                        easing: 'easeInOutQuad',
                        step: function () {
                            $this.text(Math.floor(this.countNum).toLocaleString());
                        },
                        complete: function () {
                            $this.text(countTo.toLocaleString() + '+');
                        }
                    });
                });
            }

            // Trigger counter animation when stats section comes into view
            const statsSection = document.querySelector('.stats-section');
            if (statsSection) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            animateCounters();
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.5 });

                observer.observe(statsSection);
            }

            // Quick search tag clicks
            $('.quick-tag').click(function () {
                const searchTerm = $(this).text();
                $('input[name="searchTerm"]').val(searchTerm);
                $(this).closest('form').submit();
            });

            // Enhanced search form validation
            $('.search-form').on('submit', function (e) {
                const searchTerm = $('input[name="searchTerm"]').val().trim();
                const location = $('input[name="location"]').val().trim();

                if (!searchTerm && !location) {
                    e.preventDefault();
                    showToast('Please enter a job title or location to search', 'warning');
                    return false;
                }
            });

            // Save job functionality (placeholder)
            $('.save-job-btn').click(function (e) {
                e.preventDefault();
                e.stopPropagation();

                const $btn = $(this);
                const $icon = $btn.find('i');

                if ($icon.hasClass('far')) {
                    $icon.removeClass('far').addClass('fas');
                    $btn.addClass('btn-danger').removeClass('btn-light');
                    showToast('Job saved successfully!', 'success');
                } else {
                    $icon.removeClass('fas').addClass('far');
                    $btn.addClass('btn-light').removeClass('btn-danger');
                    showToast('Job removed from saved list', 'info');
                }
            });

            console.log("Enhanced home page loaded with optimized sections");
        });

        // Toast notification function
        function showToast(message, type = 'info') {
            const toastId = 'toast-' + Date.now();
            const toastHtml = `
                        <div id="${toastId}" class="toast align-items-center text-white bg-${type} border-0" role="alert" 
                             style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
                            <div class="d-flex">
                                <div class="toast-body">
                                    <i class="fas fa-${type === 'success' ? 'check-circle' :
                    type === 'warning' ? 'exclamation-triangle' :
                        type === 'danger' ? 'times-circle' : 'info-circle'} me-2"></i>
                                    ${message}
                                </div>
                                <button type="button" class="btn-close btn-close-white me-2 m-auto" 
                                        data-bs-dismiss="toast"></button>
                            </div>
                        </div>
                    `;

            $('body').append(toastHtml);
            const toast = new bootstrap.Toast(document.getElementById(toastId), {
                autohide: true,
                delay: 4000
            });
            toast.show();

            // Remove toast element after it's hidden
            document.getElementById(toastId).addEventListener('hidden.bs.toast', function () {
                this.remove();
            });
        }
    </script>
}